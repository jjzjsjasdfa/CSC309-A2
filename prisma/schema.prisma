datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

generator client {
  provider = "prisma-client-js"
}

enum RoleType {
  regular
  cashier
  manager
  superuser
}

enum TransactionType {
  purchase
  redemption
  adjustment
  event
  transfer
}

enum PromotionType {
  automatic
  onetime
}

model User {
  id         Int         @id @default(autoincrement())
  utorid     String      @unique
  password   String?
  name       String
  email      String      @unique
  birthday   DateTime?
  role       RoleType
  points     Int         @default(0)
  createdAt  DateTime    @default(now())
  lastLogin  DateTime?
  verified   Boolean     @default(false)
  activated  Boolean     @default(false)
  suspicious Boolean     @default(false)
  expiresAt  DateTime
  resetToken String
  avatarUrl  String?
  promotions Promotion[] @relation("UserPomotions")
}

model Promotion {
  id          Int      @id @default(autoincrement())
  name        String
  description String
  type        PromotionType
  startTime   DateTime
  endTime     DateTime
  minSpending Int?
  rate        Int?
  points      Int?
  users       User[]   @relation("UserPomotions")
  available   Boolean  @default(false)
}

model Event {
  id          Int      @id @default(autoincrement())
  name        String
  description String
  location    String
  startTime   DateTime
  endTime     DateTime
  capacity    Int?
  points      Int
  organizerId Int    
  organizer   User  @relation(fields:[organizerId],references:[id])
}